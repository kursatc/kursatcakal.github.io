<!doctype html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <title>KURSAT CAKAL</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic,700,700italic,300italic,300&amp;subset=latin,cyrillic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Montserrat:400,700&amp;subset=latin,cyrillic' rel='stylesheet' type='text/css'>
    <link rel="icon" type="image/png" href="img/kc.png" />
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/flexslider.css">
    <link rel="stylesheet" href="css/jquery.fancybox.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/media.css">
    <link href="css/social-circles.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="css/color/color_4.css" id="theme-color">





    <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
    <![endif]-->

</head>
<body class="header-v2">



    <div class="top">
        <!-- Header -->
        <header class="header">

            <!-- Logotype -->
            <p style="font-family:batmanForever2; font-size:23px;" class="header-logo">
                <a href="index.html" style="font-family:batmanForever; font-size:23px;">

                    KURSAT
                </a>
                CAKAL
            </p>

            <!-- Topmenu Toggle -->
            <div class="mainmenu-btn" id="mainmenu-btn">
                <div class="mainmenu-btn-line"></div>
                <div class="mainmenu-btn-line"></div>
                <div class="mainmenu-btn-line"></div>
                <div class="mainmenu-btn-line"></div>
            </div>

            <!-- Search Form -->
            <div class="header-search">
                <a href="#" id="header-search-btn" class="header-search-btn"><i class="fa fa-search"></i></a>
                <form action="#" id="header-search">
                    <input type="text" placeholder="Search..">
                    <button style="color:rgba(245, 255, 0, 0.70)" type="submit"><i class="fa fa-search"></i></button>
                </form>
            </div>

        </header>
        <!-- Header -->
      
	</div>


    <!-- Navmenu -->
    <div class="mainmenu-bg" id="mainmenu-bg"></div>
    <nav class="mainmenu" id="mainmenu">
        <ul>
            <li style="font-family:batmanForever;">
                <a href="index.html">Home <i class=""></i></a>
            </li>
            <li class="mainmenu-parent active" style="font-family:batmanForever;">
                <a href="index.html">Blog <i class="fa fa-angle-down"></i></a>
                <ul class="mainmenu-mega-menu">
                    <li class="mainmenu-parent">
                        <a href="index.html">Blog <i class="fa fa-angle-down"></i></a>
                        <ul>
                            <a href="kursatcakal.azurewebsites.net">YÖNETİCİ PANEL</a>
                        </ul>
                    </li>
                </ul>
            </li>
            <li class="mainmenu-parent" style="font-family:batmanForever;">
                <a href="index.html">About <i class="fa fa-angle-down"></i></a>
                <ul>
                    <li>
                        <a href="CV.html">CV<i class="icon-dribbble"></i></a>
                    </li>
                </ul>
            </li>

        </ul>
    </nav>
    <!-- Navmenu -->
    <!-- Main Content -->
    <main>


        <!-- Blog Sections -->
        <div class="cont blog-sections-wrap" id="blog-sections">
            <div class="blog-sections-inner">
                <ul class="blog-sections">
                    <li class="active">
                        <a href="#">Posts</a>
                    </li>
                    <li>
                        <a href="#">Computer Science</a>
                    </li>
                    <li>
                        <a href="#">Deep Learning</a>
                    </li>
                    <li>
                        <a href="#">Robotic</a>
                    </li>
                    <li>
                        <a href="#">Computer Vision</a>
                    </li>
                    <li>
                        <a href="#">Other</a>
                    </li>
                </ul>
            </div>
        </div>
        <!-- Blog Sections -->
        <div class="cont">
            <div class="post">

                <!-- Post Content -->
                <div class="post-info">
                    <time datetime="2016-05-01 15:15">
                        <span>24</span>
                        Dec
                    </time>
                    <a href="#">Category : Cryptography</a>
                    <h1>Autonomous Cryptography</h1>
                </div>
                <p>
                    Autonomous System Cryptography for Remote Keyless and Actual Coordinates
			
			
                    <iframe src="https://drive.google.com/file/d/1X-WNyN2Z9PvB57RXkK-Jm4JbIgYqQ-KT/preview" width="100%;" height="1000px;">  </iframe>
                    <!--<iframe src="https://onedrive.live.com/embed?cid=E91F373E6C09F00E&resid=E91F373E6C09F00E%2110666&authkey=ACyWyZP6lAkPpSI&em=2" width="100%" height="1080" frameborder="0" scrolling="no"></iframe>-->
                   <!--Code Content-->
                    <div style="background: #111111; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #fb660a; font-weight: bold">import</span> <span style="color: #ffffff">binascii</span>
<span style="color: #fb660a; font-weight: bold">class</span> <span style="color: #ffffff">Present:</span>

    <span style="color: #fb660a; font-weight: bold">def</span> <span style="color: #ff0086; font-weight: bold">__init__</span><span style="color: #ffffff">(self,</span> <span style="color: #ffffff">key,</span> <span style="color: #ffffff">rounds=</span><span style="color: #0086f7; font-weight: bold">32</span><span style="color: #ffffff">):</span>

        <span style="color: #ffffff">self.rounds</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">rounds</span>
        <span style="color: #fb660a; font-weight: bold">if</span> <span style="color: #ffffff">len(key)</span> <span style="color: #ffffff">*</span> <span style="color: #0086f7; font-weight: bold">8</span> <span style="color: #ffffff">==</span> <span style="color: #0086f7; font-weight: bold">80</span><span style="color: #ffffff">:</span>
            <span style="color: #ffffff">self.roundkeys</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">generateRoundkeys80(string2number(key),</span> <span style="color: #ffffff">self.rounds)</span>
        <span style="color: #fb660a; font-weight: bold">elif</span> <span style="color: #ffffff">len(key)</span> <span style="color: #ffffff">*</span> <span style="color: #0086f7; font-weight: bold">8</span> <span style="color: #ffffff">==</span> <span style="color: #0086f7; font-weight: bold">128</span><span style="color: #ffffff">:</span>
            <span style="color: #ffffff">self.roundkeys</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">generateRoundkeys128(string2number(key),</span> <span style="color: #ffffff">self.rounds)</span>
        <span style="color: #fb660a; font-weight: bold">else</span><span style="color: #ffffff">:</span>
            <span style="color: #fb660a; font-weight: bold">print</span><span style="color: #ffffff">(</span><span style="color: #0086d2">&quot;Key must be a 128-bit or 80-bit rawstring&quot;</span><span style="color: #ffffff">)</span>

    <span style="color: #fb660a; font-weight: bold">def</span> <span style="color: #ff0086; font-weight: bold">encrypt</span><span style="color: #ffffff">(self,</span> <span style="color: #ffffff">block):</span>
      
        <span style="color: #ffffff">state</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">string2number(block)</span>
        <span style="color: #fb660a; font-weight: bold">for</span> <span style="color: #ffffff">i</span> <span style="color: #ffffff">in</span> <span style="color: #ffffff">range(self.rounds</span> <span style="color: #ffffff">-</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">):</span>
            <span style="color: #ffffff">state</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">addRoundKey(state,</span> <span style="color: #ffffff">self.roundkeys[i])</span>
            <span style="color: #ffffff">state</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">sBoxLayer(state)</span>
            <span style="color: #ffffff">state</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">pLayer(state)</span>
        <span style="color: #ffffff">cipher</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">addRoundKey(state,</span> <span style="color: #ffffff">self.roundkeys[-</span><span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">])</span>
        <span style="color: #fb660a; font-weight: bold">return</span> <span style="color: #ffffff">number2string_N(cipher,</span> <span style="color: #0086f7; font-weight: bold">8</span><span style="color: #ffffff">)</span>

    <span style="color: #fb660a; font-weight: bold">def</span> <span style="color: #ff0086; font-weight: bold">decrypt</span><span style="color: #ffffff">(self,</span> <span style="color: #ffffff">block):</span>
      
        <span style="color: #ffffff">state</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">string2number(block)</span>
        <span style="color: #fb660a; font-weight: bold">for</span> <span style="color: #ffffff">i</span> <span style="color: #ffffff">in</span> <span style="color: #ffffff">range(self.rounds</span> <span style="color: #ffffff">-</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">):</span>
            <span style="color: #ffffff">state</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">addRoundKey(state,</span> <span style="color: #ffffff">self.roundkeys[-i</span> <span style="color: #ffffff">-</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">])</span>
            <span style="color: #ffffff">state</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">pLayer_dec(state)</span>
            <span style="color: #ffffff">state</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">sBoxLayer_dec(state)</span>
        <span style="color: #ffffff">decipher</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">addRoundKey(state,</span> <span style="color: #ffffff">self.roundkeys[</span><span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">])</span>
        <span style="color: #fb660a; font-weight: bold">return</span> <span style="color: #ffffff">number2string_N(decipher,</span> <span style="color: #0086f7; font-weight: bold">8</span><span style="color: #ffffff">)</span>

    <span style="color: #fb660a; font-weight: bold">def</span> <span style="color: #ff0086; font-weight: bold">get_block_size</span><span style="color: #ffffff">(self):</span>
        <span style="color: #fb660a; font-weight: bold">return</span> <span style="color: #0086f7; font-weight: bold">8</span>


<span style="color: #008800; font-style: italic; background-color: #0f140f">#        0   1   2   3   4   5   6   7   8   9   a   b   c   d   e   f</span>
<span style="color: #ffffff">Sbox</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">[</span><span style="color: #0086f7; font-weight: bold">0xc</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">0x5</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">0x6</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">0xb</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">0x9</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">0x0</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">0xa</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">0xd</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">0x3</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">0xe</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">0xf</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">0x8</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">0x4</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">0x7</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">0x1</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">0x2</span><span style="color: #ffffff">]</span>
<span style="color: #ffffff">Sbox_inv</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">[Sbox.index(x)</span> <span style="color: #fb660a; font-weight: bold">for</span> <span style="color: #ffffff">x</span> <span style="color: #ffffff">in</span> <span style="color: #ffffff">range(</span><span style="color: #0086f7; font-weight: bold">16</span><span style="color: #ffffff">)]</span>
<span style="color: #ffffff">PBox</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">[</span><span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">16</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">32</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">48</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">17</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">33</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">49</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">18</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">34</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">50</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">3</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">19</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">35</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">51</span><span style="color: #ffffff">,</span>
        <span style="color: #0086f7; font-weight: bold">4</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">20</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">36</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">52</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">5</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">21</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">37</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">53</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">6</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">22</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">38</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">54</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">7</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">23</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">39</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">55</span><span style="color: #ffffff">,</span>
        <span style="color: #0086f7; font-weight: bold">8</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">24</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">40</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">56</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">9</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">25</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">41</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">57</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">10</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">26</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">42</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">58</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">11</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">27</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">43</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">59</span><span style="color: #ffffff">,</span>
        <span style="color: #0086f7; font-weight: bold">12</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">28</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">44</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">60</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">13</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">29</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">45</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">61</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">14</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">30</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">46</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">62</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">15</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">31</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">47</span><span style="color: #ffffff">,</span> <span style="color: #0086f7; font-weight: bold">63</span><span style="color: #ffffff">]</span>

<span style="color: #ffffff">PBox_inv</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">[PBox.index(x)</span> <span style="color: #fb660a; font-weight: bold">for</span> <span style="color: #ffffff">x</span> <span style="color: #ffffff">in</span> <span style="color: #ffffff">range(</span><span style="color: #0086f7; font-weight: bold">64</span><span style="color: #ffffff">)]</span>


<span style="color: #fb660a; font-weight: bold">def</span> <span style="color: #ff0086; font-weight: bold">generateRoundkeys80</span><span style="color: #ffffff">(key,</span> <span style="color: #ffffff">rounds):</span>
   
    <span style="color: #ffffff">roundkeys</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">[]</span>
    <span style="color: #fb660a; font-weight: bold">for</span> <span style="color: #ffffff">i</span> <span style="color: #ffffff">in</span> <span style="color: #ffffff">range(</span><span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">,</span> <span style="color: #ffffff">rounds</span> <span style="color: #ffffff">+</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">):</span>  <span style="color: #008800; font-style: italic; background-color: #0f140f"># (K1 ... K32)</span>
        <span style="color: #008800; font-style: italic; background-color: #0f140f"># rawkey: used in comments to show what happens at bitlevel</span>
        <span style="color: #008800; font-style: italic; background-color: #0f140f"># rawKey[0:64]</span>
        <span style="color: #ffffff">roundkeys.append(key</span> <span style="color: #ffffff">&gt;&gt;</span> <span style="color: #0086f7; font-weight: bold">16</span><span style="color: #ffffff">)</span>
        <span style="color: #008800; font-style: italic; background-color: #0f140f"># 1. Shift</span>
        <span style="color: #008800; font-style: italic; background-color: #0f140f"># rawKey[19:len(rawKey)]+rawKey[0:19]</span>
        <span style="color: #ffffff">key</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">((key</span> <span style="color: #ffffff">&amp;</span> <span style="color: #ffffff">(</span><span style="color: #0086f7; font-weight: bold">2</span> <span style="color: #ffffff">**</span> <span style="color: #0086f7; font-weight: bold">19</span> <span style="color: #ffffff">-</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">))</span> <span style="color: #ffffff">&lt;&lt;</span> <span style="color: #0086f7; font-weight: bold">61</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">+</span> <span style="color: #ffffff">(key</span> <span style="color: #ffffff">&gt;&gt;</span> <span style="color: #0086f7; font-weight: bold">19</span><span style="color: #ffffff">)</span>
        <span style="color: #008800; font-style: italic; background-color: #0f140f"># 2. SBox</span>
        <span style="color: #008800; font-style: italic; background-color: #0f140f"># rawKey[76:80] = S(rawKey[76:80])</span>
        <span style="color: #ffffff">key</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">(Sbox[key</span> <span style="color: #ffffff">&gt;&gt;</span> <span style="color: #0086f7; font-weight: bold">76</span><span style="color: #ffffff">]</span> <span style="color: #ffffff">&lt;&lt;</span> <span style="color: #0086f7; font-weight: bold">76</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">+</span> <span style="color: #ffffff">(key</span> <span style="color: #ffffff">&amp;</span> <span style="color: #ffffff">(</span><span style="color: #0086f7; font-weight: bold">2</span> <span style="color: #ffffff">**</span> <span style="color: #0086f7; font-weight: bold">76</span> <span style="color: #ffffff">-</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">))</span>
        <span style="color: #008800; font-style: italic; background-color: #0f140f"># 3. Salt</span>
        <span style="color: #008800; font-style: italic; background-color: #0f140f"># rawKey[15:20] ^ i</span>
        <span style="color: #ffffff">key</span> <span style="color: #ffffff">^=</span> <span style="color: #ffffff">i</span> <span style="color: #ffffff">&lt;&lt;</span> <span style="color: #0086f7; font-weight: bold">15</span>
    <span style="color: #fb660a; font-weight: bold">return</span> <span style="color: #ffffff">roundkeys</span>


<span style="color: #fb660a; font-weight: bold">def</span> <span style="color: #ff0086; font-weight: bold">generateRoundkeys128</span><span style="color: #ffffff">(key,</span> <span style="color: #ffffff">rounds):</span>
  
    <span style="color: #ffffff">roundkeys</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">[]</span>
    <span style="color: #fb660a; font-weight: bold">for</span> <span style="color: #ffffff">i</span> <span style="color: #ffffff">in</span> <span style="color: #ffffff">range(</span><span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">,</span> <span style="color: #ffffff">rounds</span> <span style="color: #ffffff">+</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">):</span>  <span style="color: #008800; font-style: italic; background-color: #0f140f"># (K1 ... K32)</span>
        <span style="color: #008800; font-style: italic; background-color: #0f140f"># rawkey: used in comments to show what happens at bitlevel</span>
        <span style="color: #ffffff">roundkeys.append(key</span> <span style="color: #ffffff">&gt;&gt;</span> <span style="color: #0086f7; font-weight: bold">64</span><span style="color: #ffffff">)</span>
        <span style="color: #008800; font-style: italic; background-color: #0f140f"># 1. Shift</span>
        <span style="color: #ffffff">key</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">((key</span> <span style="color: #ffffff">&amp;</span> <span style="color: #ffffff">(</span><span style="color: #0086f7; font-weight: bold">2</span> <span style="color: #ffffff">**</span> <span style="color: #0086f7; font-weight: bold">67</span> <span style="color: #ffffff">-</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">))</span> <span style="color: #ffffff">&lt;&lt;</span> <span style="color: #0086f7; font-weight: bold">61</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">+</span> <span style="color: #ffffff">(key</span> <span style="color: #ffffff">&gt;&gt;</span> <span style="color: #0086f7; font-weight: bold">67</span><span style="color: #ffffff">)</span>
        <span style="color: #008800; font-style: italic; background-color: #0f140f"># 2. SBox</span>
        <span style="color: #ffffff">key</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">(Sbox[key</span> <span style="color: #ffffff">&gt;&gt;</span> <span style="color: #0086f7; font-weight: bold">124</span><span style="color: #ffffff">]</span> <span style="color: #ffffff">&lt;&lt;</span> <span style="color: #0086f7; font-weight: bold">124</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">+</span> <span style="color: #ffffff">(Sbox[(key</span> <span style="color: #ffffff">&gt;&gt;</span> <span style="color: #0086f7; font-weight: bold">120</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">&amp;</span> <span style="color: #0086f7; font-weight: bold">0xF</span><span style="color: #ffffff">]</span> <span style="color: #ffffff">&lt;&lt;</span> <span style="color: #0086f7; font-weight: bold">120</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">+</span> <span style="color: #ffffff">(key</span> <span style="color: #ffffff">&amp;</span> <span style="color: #ffffff">(</span><span style="color: #0086f7; font-weight: bold">2</span> <span style="color: #ffffff">**</span> <span style="color: #0086f7; font-weight: bold">120</span> <span style="color: #ffffff">-</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">))</span>
        <span style="color: #008800; font-style: italic; background-color: #0f140f"># 3. Salt</span>
        <span style="color: #008800; font-style: italic; background-color: #0f140f"># rawKey[62:67] ^ i</span>
        <span style="color: #ffffff">key</span> <span style="color: #ffffff">^=</span> <span style="color: #ffffff">i</span> <span style="color: #ffffff">&lt;&lt;</span> <span style="color: #0086f7; font-weight: bold">62</span>
    <span style="color: #fb660a; font-weight: bold">return</span> <span style="color: #ffffff">roundkeys</span>


<span style="color: #fb660a; font-weight: bold">def</span> <span style="color: #ff0086; font-weight: bold">addRoundKey</span><span style="color: #ffffff">(state,</span> <span style="color: #ffffff">roundkey):</span>
    <span style="color: #fb660a; font-weight: bold">return</span> <span style="color: #ffffff">state</span> <span style="color: #ffffff">^</span> <span style="color: #ffffff">roundkey</span>


<span style="color: #fb660a; font-weight: bold">def</span> <span style="color: #ff0086; font-weight: bold">sBoxLayer</span><span style="color: #ffffff">(state):</span>

    <span style="color: #ffffff">output</span> <span style="color: #ffffff">=</span> <span style="color: #0086f7; font-weight: bold">0</span>
    <span style="color: #fb660a; font-weight: bold">for</span> <span style="color: #ffffff">i</span> <span style="color: #ffffff">in</span> <span style="color: #ffffff">range(</span><span style="color: #0086f7; font-weight: bold">16</span><span style="color: #ffffff">):</span>
        <span style="color: #ffffff">output</span> <span style="color: #ffffff">+=</span> <span style="color: #ffffff">Sbox[(state</span> <span style="color: #ffffff">&gt;&gt;</span> <span style="color: #ffffff">(i</span> <span style="color: #ffffff">*</span> <span style="color: #0086f7; font-weight: bold">4</span><span style="color: #ffffff">))</span> <span style="color: #ffffff">&amp;</span> <span style="color: #0086f7; font-weight: bold">0xF</span><span style="color: #ffffff">]</span> <span style="color: #ffffff">&lt;&lt;</span> <span style="color: #ffffff">(i</span> <span style="color: #ffffff">*</span> <span style="color: #0086f7; font-weight: bold">4</span><span style="color: #ffffff">)</span>
    <span style="color: #fb660a; font-weight: bold">return</span> <span style="color: #ffffff">output</span>


<span style="color: #fb660a; font-weight: bold">def</span> <span style="color: #ff0086; font-weight: bold">sBoxLayer_dec</span><span style="color: #ffffff">(state):</span>
    
    <span style="color: #ffffff">output</span> <span style="color: #ffffff">=</span> <span style="color: #0086f7; font-weight: bold">0</span>
    <span style="color: #fb660a; font-weight: bold">for</span> <span style="color: #ffffff">i</span> <span style="color: #ffffff">in</span> <span style="color: #ffffff">range(</span><span style="color: #0086f7; font-weight: bold">16</span><span style="color: #ffffff">):</span>
        <span style="color: #ffffff">output</span> <span style="color: #ffffff">+=</span> <span style="color: #ffffff">Sbox_inv[(state</span> <span style="color: #ffffff">&gt;&gt;</span> <span style="color: #ffffff">(i</span> <span style="color: #ffffff">*</span> <span style="color: #0086f7; font-weight: bold">4</span><span style="color: #ffffff">))</span> <span style="color: #ffffff">&amp;</span> <span style="color: #0086f7; font-weight: bold">0xF</span><span style="color: #ffffff">]</span> <span style="color: #ffffff">&lt;&lt;</span> <span style="color: #ffffff">(i</span> <span style="color: #ffffff">*</span> <span style="color: #0086f7; font-weight: bold">4</span><span style="color: #ffffff">)</span>
    <span style="color: #fb660a; font-weight: bold">return</span> <span style="color: #ffffff">output</span>


<span style="color: #fb660a; font-weight: bold">def</span> <span style="color: #ff0086; font-weight: bold">pLayer</span><span style="color: #ffffff">(state):</span>
    
    <span style="color: #ffffff">output</span> <span style="color: #ffffff">=</span> <span style="color: #0086f7; font-weight: bold">0</span>
    <span style="color: #fb660a; font-weight: bold">for</span> <span style="color: #ffffff">i</span> <span style="color: #ffffff">in</span> <span style="color: #ffffff">range(</span><span style="color: #0086f7; font-weight: bold">64</span><span style="color: #ffffff">):</span>
        <span style="color: #ffffff">output</span> <span style="color: #ffffff">+=</span> <span style="color: #ffffff">((state</span> <span style="color: #ffffff">&gt;&gt;</span> <span style="color: #ffffff">i)</span> <span style="color: #ffffff">&amp;</span> <span style="color: #0086f7; font-weight: bold">0x01</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">&lt;&lt;</span> <span style="color: #ffffff">PBox[i]</span>
    <span style="color: #fb660a; font-weight: bold">return</span> <span style="color: #ffffff">output</span>


<span style="color: #fb660a; font-weight: bold">def</span> <span style="color: #ff0086; font-weight: bold">pLayer_dec</span><span style="color: #ffffff">(state):</span>
    
    <span style="color: #ffffff">output</span> <span style="color: #ffffff">=</span> <span style="color: #0086f7; font-weight: bold">0</span>
    <span style="color: #fb660a; font-weight: bold">for</span> <span style="color: #ffffff">i</span> <span style="color: #ffffff">in</span> <span style="color: #ffffff">range(</span><span style="color: #0086f7; font-weight: bold">64</span><span style="color: #ffffff">):</span>
        <span style="color: #ffffff">output</span> <span style="color: #ffffff">+=</span> <span style="color: #ffffff">((state</span> <span style="color: #ffffff">&gt;&gt;</span> <span style="color: #ffffff">i)</span> <span style="color: #ffffff">&amp;</span> <span style="color: #0086f7; font-weight: bold">0x01</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">&lt;&lt;</span> <span style="color: #ffffff">PBox_inv[i]</span>
    <span style="color: #fb660a; font-weight: bold">return</span> <span style="color: #ffffff">output</span>


<span style="color: #fb660a; font-weight: bold">def</span> <span style="color: #ff0086; font-weight: bold">string2number</span><span style="color: #ffffff">(i):</span>
   
    <span style="color: #fb660a; font-weight: bold">return</span> <span style="color: #ffffff">int(i.encode(</span><span style="color: #0086d2">&#39;hex&#39;</span><span style="color: #ffffff">),</span> <span style="color: #0086f7; font-weight: bold">16</span><span style="color: #ffffff">)</span>


<span style="color: #fb660a; font-weight: bold">def</span> <span style="color: #ff0086; font-weight: bold">number2string_N</span><span style="color: #ffffff">(i,</span> <span style="color: #ffffff">N):</span>
    
    <span style="color: #ffffff">s</span> <span style="color: #ffffff">=</span> <span style="color: #0086d2">&#39;%0*x&#39;</span> <span style="color: #ffffff">%</span> <span style="color: #ffffff">(N</span> <span style="color: #ffffff">*</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">,</span> <span style="color: #ffffff">i)</span>
    <span style="color: #fb660a; font-weight: bold">return</span> <span style="color: #ffffff">s.decode(</span><span style="color: #0086d2">&#39;hex&#39;</span><span style="color: #ffffff">)</span>


<span style="color: #fb660a; font-weight: bold">def</span> <span style="color: #ff0086; font-weight: bold">_test</span><span style="color: #ffffff">():</span>
    <span style="color: #fb660a; font-weight: bold">import</span> <span style="color: #ffffff">doctest</span>
    <span style="color: #ffffff">doctest.testmod()</span>


<span style="color: #fb660a; font-weight: bold">if</span> <span style="color: #ffffff">__name__</span> <span style="color: #ffffff">==</span> <span style="color: #0086d2">&quot;__main__&quot;</span><span style="color: #ffffff">:</span>
    <span style="color: #ffffff">_test()</span>
    <span style="color: #ffffff">key</span> <span style="color: #ffffff">=</span> <span style="color: #0086d2">&#39;10000000000000000000&#39;</span><span style="color: #ffffff">.decode(</span><span style="color: #0086d2">&#39;hex&#39;</span><span style="color: #ffffff">)</span>
    <span style="color: #008800; font-style: italic; background-color: #0f140f">#test3=binascii.unhexlify(b&#39;hello&#39;)</span>
	<span style="color: #008800; font-style: italic; background-color: #0f140f">#print(test3)</span>
    <span style="color: #ffffff">plain</span> <span style="color: #ffffff">=</span> <span style="color: #0086d2">&#39;11&#39;</span><span style="color: #ffffff">.replace(</span><span style="color: #0086d2">&#39; &#39;</span><span style="color: #ffffff">,</span> <span style="color: #0086d2">&#39;&#39;</span><span style="color: #ffffff">).decode(</span><span style="color: #0086d2">&#39;hex&#39;</span><span style="color: #ffffff">)</span>
	<span style="color: #008800; font-style: italic; background-color: #0f140f">#print(plain)</span>
    <span style="color: #ffffff">cipher</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">Present(key)</span>
    <span style="color: #ffffff">encrypted</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">cipher.encrypt(plain)</span>
    <span style="color: #fb660a; font-weight: bold">print</span><span style="color: #ffffff">(encrypted.encode(</span><span style="color: #0086d2">&#39;hex&#39;</span><span style="color: #ffffff">))</span>
	
    <span style="color: #008800; font-style: italic; background-color: #0f140f">#&#39;5579c1387b228445&#39;</span>
    <span style="color: #ffffff">decrypted</span> <span style="color: #ffffff">=</span> <span style="color: #ffffff">cipher.decrypt(encrypted)</span>
    <span style="color: #fb660a; font-weight: bold">print</span><span style="color: #ffffff">(decrypted.encode(</span><span style="color: #0086d2">&#39;hex&#39;</span><span style="color: #ffffff">))</span>
</pre></div>

                </p>
                <!-- Post Content -->


            </div>
        </div>


    </main>
    <!-- Main Content -->
    <!-- Footer -->
    <footer class="footer-wrap">
        <div class="cont footer">

            <!-- Logotype -->

            <p align="center" class="" style="font-family:batmanForever; color:white; font-size:33px;"> KURSAT CAKAL </p><br /><br />

            <!-- Subscribe -->
            <form class="form-validate footer-subscribe" action="#">
                <input data-required="text" data-required-email="email" type="text" placeholder="Email address" name="email2">
                <button type="submit">Subscribe <i class="fa fa-angle-right"></i></button>
            </form>


            <!-- Social Links -->
            <ul class="footer-social">


                <li>
                    <a href="https://www.linkedin.com/in/kursat-cakal/" rel="nofollow" target="_blank">
                        <i class="fa fa-linkedin"></i>
                    </a>
                </li>
                <li>
                    <a href="https://www.linkedin.com/in/kursat-cakal/" rel="nofollow" target="_blank">
                        <i class="fa fa-facebook"></i>
                    </a>
                </li>
                <li>
                    <a href="https://twitter.com/kursadcakal" rel="nofollow" target="_blank">
                        <i class="fa fa-twitter"></i>
                    </a>
                </li>
                <li>
                    <a href="https://www.instagram.com/kursadcakal/" rel="nofollow" target="_blank">
                        <i class="fa fa-instagram"></i>
                    </a>
                </li>
                <li>
                    <a href="https://github.com/KursatCAKAL" rel="nofollow" target="_blank">
                        <i class="icon-github social-button color"></i>
                        <!--<i style="font-family:batmanForever">Github</i>-->
                    </a>
                </li>
                <li>
                    <a href="kursatckl@gmail.com" rel="nofollow" target="_blank">
                        <i class="fa fa-envelope"></i>
                        <!--<i style="font-family:batmanForever">Github</i>-->
                    </a>
                </li>

            </ul>


        </div>
    </footer>
    <!-- Footer -->

    <script src="js/jquery-1.12.3.min.js"></script>
    <script src="js/fancybox/fancybox.js"></script>
    <script src="js/fancybox/helpers/jquery.fancybox-thumbs.js"></script>
    <script src="js/jquery.flexslider-min.js"></script>
    <script src="js/masonry.pkgd.min.js"></script>
    <script src="js/jquery.fractionslider.js"></script>
    <script src="js/main.js"></script>

    <script src="https://maps.googleapis.com/maps/api/js"></script>
    <script>
        "use strict";
        function initialize() {
            var mapOptions = {
                zoom: 15,
                scrollwheel: false,
                center: new google.maps.LatLng(40.440128, -79.974326)
            };
            var map = new google.maps.Map(document.getElementById('blog-map1'),
                mapOptions);
            var marker = new google.maps.Marker({
                position: map.getCenter(),
                icon: 'img/marker.png',
                map: map
            });
        }
        google.maps.event.addDomListener(window, 'load', initialize);
    </script>

</body>
</html>
